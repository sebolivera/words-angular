<div style="display: flex">
  <div>
    <canvas
      #editorCanvas
      id="editorCanvas"
      (click)="doClick($event)"
      (mousemove)="mouseMove($event)"
    ></canvas>
  </div>

  <div style="padding-left: 2px; width: 600px">
    <h3>Instructions:</h3>
    <ion-list>
      <ion-item style="padding-bottom: 5px; width: 100%">
        <ion-grid>
          <ion-row>
            <ion-col style="margin:auto 0px auto;" size="3"><!-- by god this is cursed -->
              <ion-label 
              [color]="validationErrors['name'] ? 'danger' : 'default'">Level Name</ion-label>
            </ion-col>
            <ion-col>
                <ion-input
                  type="text"
                  [color]="validationErrors['name'] ? 'danger' : 'default'"
                  style="width: 100%"
                  [placeholder]="
                    validationErrors['name']
                      ? 'Please enter a valid name'
                      : 'Enter a name here (it can\'t be empty)'
                  "
                  (ionChange)="setName($event.target)"
                ></ion-input
              ></ion-col
          ></ion-row>
        </ion-grid>
      </ion-item>
      <ion-item>
        <ion-label
          >Level Width:
          {{
            this.level && this.level.sizeX ? this.level.sizeX : "?"
          }}</ion-label
        >
        <ion-range
          [pin]="true"
          [pinFormatter]="pinFormatterX"
          value="10"
          min="4"
          max="50"
          (ionChange)="setLevelsizeX($event.target)"
        ></ion-range>
      </ion-item>
      <ion-item>
        <ion-label
          >Level Height:
          {{
            this.level && this.level.sizeY ? this.level.sizeY : "?"
          }}</ion-label
        >
        <ion-range
          [pin]="true"
          [pinFormatter]="pinFormatterY"
          value="10"
          min="4"
          max="50"
          (ionChange)="setLevelsizeY($event.target)"
        ></ion-range>
      </ion-item>

      <ion-item>
        <ion-grid>
          <ion-row>
            <ion-col>
              <ion-button [color]="validationErrors['entities'] ? 'danger' : 'primary'" id="entity-modal" expand="block"
                >Open Entity List</ion-button
              >
            </ion-col>
            <ion-col>
              <ion-button [color]="validationErrors['entities'] ? 'danger' : 'primary'" id="letter-modal" expand="block"
                >Open Letter List</ion-button
              >
            </ion-col></ion-row
          >
        </ion-grid>
      </ion-item>
      <ion-item>
        <ion-button
          (click)="selectEraser()"
          id="entity-modal"
          expand="block"
          [fill]="selectedEraser ? 'solid' : 'clear'"
          [color]="selectedEraser ? 'warning' : 'dark'"
        >
          <ion-icon
            [name]="selectedEraser ? 'remove-circle' : 'remove-circle-outline'"
          ></ion-icon>
          <ion-label style="margin-left: 5px">Erase</ion-label>
        </ion-button>
      </ion-item>
      <ion-item>
        <ion-button (click)="exportLevel()">Export level data</ion-button>
      </ion-item>
    </ion-list>
  </div>
</div>

<ion-modal trigger="entity-modal" (willDismiss)="onWillDismiss($event)">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancel()">Cancel</ion-button>
        </ion-buttons>
        <ion-title>Select an entity to place</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="confirm()" [strong]="true">Confirm</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content *ngIf="recordedEntities" class="ion-padding">
      <ion-list>
        <ion-item
          *ngFor="let entityGroup of recordedEntities.default | keyvalue"
        >
          <div style="display: flex; flex-direction: column">
            <h2>{{ titleCaseWord(entityGroup.key) }}</h2>
            <ion-grid col-4>
              <ion-row>
                <ion-col
                  size="4"
                  *ngFor="let entity of entityGroup.value | keyvalue"
                >
                  <span
                    [class]="{
                      clickable: entity.key !== selectedKey,
                      clicked: entity.key === selectedKey
                    }"
                    style="display: flex; flex-direction: column"
                    (click)="selectEntity(entity.key)"
                  >
                    <img
                      class="borderImg ion-text-center"
                      src="{{ imgMap[entity.key][currentFrame].src }}"
                    />
                    <h4>{{ entity.value["verboseName"] }}</h4>
                    <p>{{ entity.value["editorDescription"] }}</p>
                  </span>
                </ion-col>
              </ion-row>
            </ion-grid>
          </div>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-modal
  #letterModal
  trigger="letter-modal"
  (willDismiss)="onWillDismissLetter($event)"
>
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancelLetters()">Cancel</ion-button>
        </ion-buttons>
        <ion-title>Select a letter to place</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="confirmLetters()" [strong]="true"
            >Confirm</ion-button
          >
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content *ngIf="recordedEntities" class="ion-padding">
      <ion-list>
        <div style="display: flex; flex-direction: column">
          <h2>Available Letters</h2>
          <ion-grid col-12>
            <ion-row>
              <ion-col size="2" *ngFor="let letter of allLettersAsArray()">
                <span
                  [class]="{
                    clickable: letter !== selectedLetterKey,
                    clicked: letter === selectedLetterKey
                  }"
                  style="display: flex; flex-direction: column"
                  (click)="selectLetter(letter)"
                >
                  <img
                    class="borderImg ion-text-center"
                    src="{{ letterImgMap[letter][currentFrame].src }}"
                  />
                </span>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>
